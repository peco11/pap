<ng-container *ngIf="settingsView$|async as settingsView">
  <ion-header><pap-header></pap-header></ion-header>

  <ion-content padding class="pap-settings">
    <ion-card class="main-card">
      <ion-segment [(ngModel)]="currentStep">
        <ion-segment-button value="firstStep" (click)="step$.next(0)">
          <ion-label>Generali</ion-label>
        </ion-segment-button>
        <ion-segment-button value="secondStep" (click)="step$.next(1)">
          <ion-label>Password</ion-label>
        </ion-segment-button>
        <ion-segment-button value="thirdStep" (click)="step$.next(2)">
          <ion-label>Indirizzi</ion-label>
        </ion-segment-button>
      </ion-segment>

      <form [formGroup]="(settingsForm)!">
        <ion-list>
          <ng-container [ngSwitch]="step$|async">
            <pap-first-step-signup-form
              *ngSwitchCase="0"
              [buttons]="false"
              [disable]="['email']"
            ></pap-first-step-signup-form>
            <pap-second-step-signup-form
              *ngSwitchCase="1"
              [buttons]="false"
            ></pap-second-step-signup-form>
            <pap-third-step-signup-form
              *ngSwitchCase="2"
              [buttons]="false"
            ></pap-third-step-signup-form>
          </ng-container>
        </ion-list>
      </form>
    </ion-card>
    <ion-grid class="footer">
      <ion-row *ngIf="currentStep === 'thirdStep'">
        <ion-col class="ion-align-self-start"> </ion-col>
        <ion-col class="ion-align-self-center">
          <ion-button (click)="openModalLocation()" expand="block" shape="round"
            >Aggiungi indirizzo</ion-button
          >
        </ion-col>
        <ion-col class="ion-align-self-end"></ion-col>
      </ion-row>
      <ion-row>
        <ion-col class="ion-align-self-start">
          <ion-button fill="outline" shape="round" expand="full" (click)="logout()">
            Log out
          </ion-button>
        </ion-col>
        <ion-col class="ion-align-self-center"> </ion-col>
        <ion-col class="ion-align-self-end">
          <ion-button
            fill="solid"
            shape="round"
            expand="full"
            [disabled]="isDisabled()"
            (click)="update()"
          >
            Salva
          </ion-button>
        </ion-col>
      </ion-row>
      <ion-row *ngIf="currentStep === 'firstStep'">
        <ion-col class="ion-align-self-start"> </ion-col>
        <ion-col class="ion-align-self-center" size="8">
          <ion-button fill="outline" shape="round" expand="full" (click)="delete()">
            elimina account
          </ion-button>
        </ion-col>
        <ion-col class="ion-align-self-end"> </ion-col>
      </ion-row>
    </ion-grid>
  </ion-content>
  <ion-list>
    <ion-item *ngIf="error$|async as error">
      <ion-label color="danger">{{error}}</ion-label>
    </ion-item>
  </ion-list>
</ng-container>
<ion-footer collapse="fade">
  <pap-footer></pap-footer>
</ion-footer>
